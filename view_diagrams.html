<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pneumonia Prediction Project - Diagrams</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #2563eb;
            margin-bottom: 30px;
        }
        .diagram-container {
            background: white;
            padding: 30px;
            margin: 30px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h2 {
            color: #1e40af;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .mermaid {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 5px;
        }
        .instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #2563eb;
        }
    </style>
</head>
<body>
    <h1>Pneumonia Prediction Project - System Diagrams</h1>

    <div class="instructions">
        <strong>Instructions:</strong> These diagrams are interactive. You can view them directly in this browser, 
        or copy the Mermaid code to <a href="https://mermaid.live" target="_blank">mermaid.live</a> for editing.
        To export as images, use the export feature in mermaid.live.
    </div>

    <!-- SYSTEM ARCHITECTURE -->
    <div class="diagram-container">
        <h2>1. System Architecture Diagram</h2>
        <div class="mermaid">
graph TB

    subgraph User_Layer
        Clinician[Clinician User]
        Patient[Patient Receiving Email]
    end

    subgraph Frontend_Layer
        Frontend[Django UI
        - Upload X-ray
        - Enter patient details
        - View prediction
        - Download PDF]
    end

    subgraph Backend_Layer
        Backend[Django Backend
        - Save Prediction
        - Call ML Model
        - Send Email to Patient
        - Generate PDF Report]
    end

    subgraph ML_Processing
        MLModel[CNN Model for Pneumonia Detection]
    end

    subgraph Storage_Layer
        DB[(SQLite Database)]
        Media[(Media Storage)]
    end

    subgraph Email_Service
        EmailSMTP[SMTP Mail Server]
    end

    subgraph PDF_Service
        PDFGen[xhtml2pdf Generator]
    end

    Clinician --> Frontend
    Frontend --> Backend
    Backend --> MLModel
    MLModel --> Backend
    Backend --> DB
    Backend --> Media
    Backend --> EmailSMTP
    EmailSMTP --> Patient
    Backend --> PDFGen
    Frontend --> Clinician


        </div>
    </div>

    <!-- USE CASE -->
    <div class="diagram-container">
        <h2>2. Use Case Diagram</h2>
        <div class="mermaid">
graph LR

    subgraph Pneumonia_Prediction_System
        UC1[Clinician Login]
        UC2[Upload Patient X-ray]
        UC3[Enter Patient Name + Email]
        UC4[View Prediction]
        UC5[Download PDF Report]
        UC6[Dashboard of Predictions]
        UC7[Patient Receives Email Result]
    end

    Clinician[Clinician User] --> UC1
    Clinician --> UC2
    Clinician --> UC3
    Clinician --> UC4
    Clinician --> UC5
    Clinician --> UC6

    Patient[Patient] --> UC7



        </div>
    </div>

    <!-- WORKFLOW -->
    <div class="diagram-container">
        <h2>3. Workflow Diagram (Updated: Email + PDF)</h2>
        <div class="mermaid">
flowchart TD

    Start([Clinician Access]) --> Login{Logged in?}
    Login -->|No| Auth[Login/Register]
    Auth --> Login
    Login -->|Yes| Upload[Select and Upload X-ray]

    Upload --> EnterDetails[Enter Patient Name and Email]

    EnterDetails --> SaveImage[Save X-ray to Media]

    SaveImage --> Preprocess[Preprocess Image]
    Preprocess --> Predict[ML Model Prediction]
    Predict --> Prob[Extract Probability]

    Prob --> Decision{Normal or Pneumonia}

    Decision -->|Normal| NormalResult[Normal Result]
    Decision -->|Pneumonia| PositiveResult[Pneumonia Result]

    NormalResult --> SaveDB[Save to Database]
    PositiveResult --> SaveDB

    SaveDB --> SendEmail[Send Email to Patient]

    SendEmail --> PDF[Generate PDF Report]

    PDF --> DisplayClinician[Display Result to Clinician]

    DisplayClinician --> Dashboard[Clinician Dashboard]

    Dashboard --> End([End])

        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
</body>
</html>
